(function(a){var b=window,h,j,l,i,p,e,g,c,d;Object.keys||(Object.keys=function(){'use strict';var b=Object.prototype.hasOwnProperty,c=!{toString:null}.propertyIsEnumerable('toString'),a=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],d=a.length;return function(e){if(typeof e!='object'&&(typeof e!='function'||e===null))throw new TypeError('Object.keys called on non-object');var g=[],h,f;for(h in e)b.call(e,h)&&g.push(h);if(c)for(f=0;f<d;f++)b.call(e,a[f])&&g.push(a[f]);return g}}()),h=!1,j=200,l=location.hash==="#debug";function t(a){l&&console.log(a)}i=["Days","Hours","Minutes","Seconds"],p={Seconds:"Minutes",Minutes:"Hours",Hours:"Days",Days:"Years"},e={Seconds:1,Minutes:60,Hours:3600,Days:86400,Months:2678400,Years:31536e3};function o(b){var c=/^rgba?\(([\d]+),([\d]+),([\d]+)(,([\d\.]+))?\)$/,a,d;return c.test(b)?(a=c.exec(b),{r:parseInt(a[1]),g:parseInt(a[2]),b:parseInt(a[3]),a:parseInt(a[5]?a[5]:1)}):(d=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,b=b.replace(d,function(d,a,b,c){return a+a+b+b+c+c}),a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b),a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null)}function s(){var a=document.createElement('canvas');return!!(a.getContext&&a.getContext('2d'))}function f(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function m(){return f()+f()+'-'+f()+'-'+f()+'-'+f()+'-'+f()+f()+f()}Array.prototype.indexOf||(Array.prototype.indexOf=function(c){var b=this.length>>>0,a=Number(arguments[1])||0;for(a=a<0?Math.ceil(a):Math.floor(a),a<0&&(a+=b);a<b;a++)if(a in this&&this[a]===c)return a;return-1});function n(b){var e=b.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}\s[0-9]{1,2}:[0-9]{2}:[0-9]{2}$/),f,c,d,a;return e!==null&&e.length>0?(f=b.split(" "),c=f[0].split("-"),d=f[1].split(":"),new Date(c[0],c[1]-1,c[2],d[0],d[1],d[2])):(a=Date.parse(b),!isNaN(a))?a:(a=Date.parse(b.replace(/-/g,'/').replace('T',' ')),!isNaN(a))?a:new Date}function k(r,q,p,n,o){for(var m={},j={},i={},h={},k={},l={},g=null,f=0,a,d,c,b;f<n.length;f++)a=n[f],g===null?d=p/e[a]:d=e[g]/e[a],c=r/e[a],b=q/e[a],o&&(c>0?c=Math.floor(c):c=Math.ceil(c),b>0?b=Math.floor(b):b=Math.ceil(b)),a!=="Days"&&(c=c%d,b=b%d),m[a]=c,i[a]=Math.abs(c),j[a]=b,l[a]=Math.abs(b),h[a]=Math.abs(c)/d,k[a]=Math.abs(b)/d,g=a;return{raw_time:m,raw_old_time:j,time:i,old_time:l,pct:h,old_pct:k}}g={};function q(){typeof b.TC_Instance_List!="undefined"?g=b.TC_Instance_List:b.TC_Instance_List=g,r(b)}function r(a){for(var c=['webkit','moz'],b=0;b<c.length&&!a.requestAnimationFrame;++b)a.requestAnimationFrame=a[c[b]+'RequestAnimationFrame'],a.cancelAnimationFrame=a[c[b]+'CancelAnimationFrame'];(!a.requestAnimationFrame||!a.cancelAnimationFrame)&&(a.requestAnimationFrame=function(f,g,b){var c,d,e;return typeof b=="undefined"&&(b={data:{last_frame:0}}),c=(new Date).getTime(),d=Math.max(0,16-(c-b.data.last_frame)),e=a.setTimeout(function(){f(c+d)},d),b.data.last_frame=c+d,e},a.cancelAnimationFrame=function(a){clearTimeout(a)})}c=function(a,b){this.element=a,this.container,this.listeners=null,this.data={paused:!1,last_frame:0,animation_frame:null,interval_fallback:null,timer:!1,total_duration:null,prev_time:null,drawn_units:[],text_elements:{Days:null,Hours:null,Minutes:null,Seconds:null},attributes:{canvas:null,context:null,item_size:null,line_width:null,radius:null,outer_radius:null},state:{fading:{Days:!1,Hours:!1,Minutes:!1,Seconds:!1}}},this.config=null,this.setOptions(b),this.initialize()},c.prototype.clearListeners=function(){this.listeners={all:[],visible:[]}},c.prototype.addTime=function(a){if(this.data.attributes.ref_date instanceof Date){var b=this.data.attributes.ref_date;b.setSeconds(b.getSeconds()+a)}else isNaN(this.data.attributes.ref_date)||(this.data.attributes.ref_date+=a*1e3)},c.prototype.initialize=function(m){var f,n,c,d,g,j,i,e,k,l,o;this.data.drawn_units=[];for(f=0;f<Object.keys(this.config.time).length;f++)n=Object.keys(this.config.time)[f],this.config.time[n].show&&this.data.drawn_units.push(n);a(this.element).children('div.time_circles').remove(),typeof m=="undefined"&&(m=!0),(m||this.listeners===null)&&this.clearListeners(),this.container=a("<div>"),this.container.addClass('time_circles'),this.container.appendTo(this.element),c=this.element.offsetHeight,d=this.element.offsetWidth,c===0&&(c=a(this.element).height()),d===0&&(d=a(this.element).width()),c===0&&d>0?c=d/this.data.drawn_units.length:d===0&&c>0&&(d=c*this.data.drawn_units.length),g=document.createElement('canvas'),g.width=d,g.height=c,this.data.attributes.canvas=a(g),this.data.attributes.canvas.appendTo(this.container),j=s(),!j&&typeof G_vmlCanvasManager!="undefined"&&(G_vmlCanvasManager.initElement(g),h=!0,j=!0),j&&(this.data.attributes.context=g.getContext('2d')),this.data.attributes.item_size=Math.min(d/this.data.drawn_units.length,c),this.data.attributes.line_width=this.data.attributes.item_size*this.config.fg_width,this.data.attributes.radius=(this.data.attributes.item_size*.8-this.data.attributes.line_width)/2,this.data.attributes.outer_radius=this.data.attributes.radius+.5*Math.max(this.data.attributes.line_width,this.data.attributes.line_width*this.config.bg_width),f=0;for(i in this.data.text_elements){if(!this.config.time[i].show)continue;e=a("<div>"),e.addClass('textDiv_'+i),e.css("top",Math.round(.35*this.data.attributes.item_size)),e.css("left",Math.round(f++*this.data.attributes.item_size)),e.css("width",this.data.attributes.item_size),e.appendTo(this.container),k=a("<span>"),k.css("font-size",Math.round(this.config.number_size*this.data.attributes.item_size)),k.appendTo(e),l=a("<h4>"),l.text(this.config.time[i].text),l.css("font-size",Math.round(this.config.text_size*this.data.attributes.item_size)),l.appendTo(e),this.data.text_elements[i]=k}this.start(),this.config.start||(this.data.paused=!0),o=this,this.data.interval_fallback=b.setInterval(function(){o.update.call(o,!0)},100)},c.prototype.update=function(r){var g,s,t,q,f,a,n,o,m,w,c,u,v,l,y,d,x,p;if(typeof r=="undefined")r=!1;else if(r&&this.data.paused)return;if(h&&this.data.attributes.context.clearRect(0,0,this.data.attributes.canvas[0].width,this.data.attributes.canvas[0].hright),t=this.data.prev_time,q=new Date,this.data.prev_time=q,t===null&&(t=q),!this.config.count_past_zero)if(q>this.data.attributes.ref_date){for(f=0;f<this.data.drawn_units.length;f++)a=this.data.drawn_units[f],this.data.text_elements[a].text("0"),n=f*this.data.attributes.item_size+this.data.attributes.item_size/2,o=this.data.attributes.item_size/2,m=this.config.time[a].color,this.drawArc(n,o,m,0);this.stop();return}g=(this.data.attributes.ref_date-q)/1e3,s=(this.data.attributes.ref_date-t)/1e3,w=this.config.animation!=="smooth",c=k(g,s,this.data.total_duration,this.data.drawn_units,w),u=k(g,s,e.Years,i,w),f=0,v=0,l=null,y=this.data.drawn_units.slice();for(f in i){if(a=i[f],Math.floor(u.raw_time[a])!==Math.floor(u.raw_old_time[a])&&this.notifyListeners(a,Math.floor(u.time[a]),Math.floor(g),"all"),y.indexOf(a)<0)continue;Math.floor(c.raw_time[a])!==Math.floor(c.raw_old_time[a])&&this.notifyListeners(a,Math.floor(c.time[a]),Math.floor(g),"visible"),r||(this.data.text_elements[a].text(Math.floor(Math.abs(c.time[a]))),n=v*this.data.attributes.item_size+this.data.attributes.item_size/2,o=this.data.attributes.item_size/2,m=this.config.time[a].color,this.config.animation==="smooth"?(l!==null&&!h&&(Math.floor(c.time[l])>Math.floor(c.old_time[l])?(this.radialFade(n,o,m,1,a),this.data.state.fading[a]=!0):Math.floor(c.time[l])<Math.floor(c.old_time[l])&&(this.radialFade(n,o,m,0,a),this.data.state.fading[a]=!0)),this.data.state.fading[a]||this.drawArc(n,o,m,c.pct[a])):this.animateArc(n,o,m,c.pct[a],c.old_pct[a],(new Date).getTime()+j)),l=a,v++}if(this.data.paused||r)return;d=this,x=function(){d.update.call(d)},this.config.animation==="smooth"?this.data.animation_frame=b.requestAnimationFrame(x,d.element,d):(p=g%1*1e3,p<0&&(p=1e3+p),p+=50,d.data.animation_frame=b.setTimeout(function(){d.data.animation_frame=b.requestAnimationFrame(x,d.element,d)},p))},c.prototype.animateArc=function(c,f,d,e,g,h){var i,a,k,l;if(this.data.attributes.context===null)return;if(i=g-e,Math.abs(i)>.5)e===0?this.radialFade(c,f,d,1):this.radialFade(c,f,d,0);else{if(a=(j-(h-(new Date).getTime()))/j,a>1&&(a=1),k=g*(1-a)+e*a,this.drawArc(c,f,d,k),a>=1)return;l=this,b.requestAnimationFrame(function(){l.animateArc(c,f,d,e,g,h)},this.element)}},c.prototype.drawArc=function(f,g,k,l){var d,a,b,c,i,j,e;if(this.data.attributes.context===null)return;d=Math.max(this.data.attributes.outer_radius,this.data.attributes.item_size/2),h||this.data.attributes.context.clearRect(f-d,g-d,d*2,d*2),this.config.use_background&&(this.data.attributes.context.beginPath(),this.data.attributes.context.arc(f,g,this.data.attributes.radius,0,2*Math.PI,!1),this.data.attributes.context.lineWidth=this.data.attributes.line_width*this.config.bg_width,this.data.attributes.context.strokeStyle=this.config.circle_bg_color,this.data.attributes.context.stroke()),i=-.5*Math.PI,j=2*Math.PI,a=i+this.config.start_angle/360*j,e=2*l*Math.PI,this.config.direction==="Both"?(c=!1,a-=e/2,b=a+e):this.config.direction==="Clockwise"?(c=!1,b=a+e):(c=!0,b=a-e),this.data.attributes.context.beginPath(),this.data.attributes.context.arc(f,g,this.data.attributes.radius,a,b,c),this.data.attributes.context.lineWidth=this.data.attributes.line_width,this.data.attributes.context.strokeStyle=k,this.data.attributes.context.stroke()},c.prototype.radialFade=function(h,g,j,a,f){var d=o(j),e=this,i=.2*(a===1?-1:1),c;for(c=0;a<=1&&a>=0;c++)(function(){var f=50*c,i="rgba("+d.r+", "+d.g+", "+d.b+", "+Math.round(a*10)/10+")";b.setTimeout(function(){e.drawArc(h,g,i,1)},f)})(),a+=i;typeof f!==void 0&&b.setTimeout(function(){e.data.state.fading[f]=!1},50*c)},c.prototype.timeLeft=function(){if(this.data.paused&&typeof this.data.timer=="number")return this.data.timer;var a=new Date;return(this.data.attributes.ref_date-a)/1e3},c.prototype.start=function(){var d,c;b.cancelAnimationFrame(this.data.animation_frame),b.clearTimeout(this.data.animation_frame),d=a(this.element).data('date'),typeof d=="undefined"&&(d=a(this.element).attr('data-date')),typeof d=="string"?this.data.attributes.ref_date=n(d):typeof this.data.timer=="number"?this.data.paused&&(this.data.attributes.ref_date=(new Date).getTime()+this.data.timer*1e3):(c=a(this.element).data('timer'),typeof c=="undefined"&&(c=a(this.element).attr('data-timer')),typeof c=="string"&&(c=parseFloat(c)),typeof c=="number"?(this.data.timer=c,this.data.attributes.ref_date=(new Date).getTime()+c*1e3):this.data.attributes.ref_date=this.config.ref_date),this.data.paused=!1,this.update.call(this)},c.prototype.restart=function(){this.data.timer=!1,this.start()},c.prototype.stop=function(){typeof this.data.timer=="number"&&(this.data.timer=this.timeLeft(this)),this.data.paused=!0,b.cancelAnimationFrame(this.data.animation_frame)},c.prototype.destroy=function(){this.clearListeners(),this.stop(),b.clearInterval(this.data.interval_fallback),this.data.interval_fallback=null,this.container.remove(),a(this.element).removeAttr('data-tc-id'),a(this.element).removeData('tc-id')},c.prototype.setOptions=function(f){var c,d;if(this.config===null&&(this.default_options.ref_date=new Date,this.config=a.extend(!0,{},this.default_options)),a.extend(!0,this.config,f),this.config.use_top_frame?b=window.top:b=window,q(),this.data.total_duration=this.config.total_duration,typeof this.data.total_duration=="string")if(typeof e[this.data.total_duration]!="undefined")this.data.total_duration=e[this.data.total_duration];else if(this.data.total_duration==="Auto"){for(c=0;c<Object.keys(this.config.time).length;c++)if(d=Object.keys(this.config.time)[c],this.config.time[d].show){this.data.total_duration=e[p[d]];break}}else this.data.total_duration=e.Years,console.error("Valid values for TimeCircles config.total_duration are either numeric, or (string) Years, Months, Days, Hours, Minutes, Auto")},c.prototype.addListener=function(b,c,a){if(typeof b!="function")return;typeof a=="undefined"&&(a="visible"),this.listeners[a].push({func:b,scope:c})},c.prototype.notifyListeners=function(d,e,f,b){for(var a=0,c;a<this.listeners[b].length;a++)c=this.listeners[b][a],c.func.apply(c.scope,[d,e,f])},c.prototype.default_options={ref_date:new Date,start:!0,animation:"smooth",count_past_zero:!0,circle_bg_color:"#60686F",use_background:!0,fg_width:.1,bg_width:1.2,text_size:.07,number_size:.28,total_duration:"Auto",direction:"Clockwise",use_top_frame:!1,start_angle:0,time:{Days:{show:!0,text:"Days",color:"#FC6"},Hours:{show:!0,text:"Hours",color:"#9CF"},Minutes:{show:!0,text:"Minutes",color:"#BFB"},Seconds:{show:!0,text:"Seconds",color:"#F99"}}},d=function(a,b){this.elements=a,this.options=b,this.foreach()},d.prototype.getInstance=function(f){var b=a(f).data("tc-id"),d,h,e;return typeof b=="undefined"&&(b=m(),a(f).attr("data-tc-id",b)),typeof g[b]=="undefined"?(h=this.options,e=a(f).data('options'),typeof e=="string"&&(e=JSON.parse(e)),typeof e=="object"&&(h=a.extend(!0,{},this.options,e)),d=new c(f,h),g[b]=d):(d=g[b],typeof this.options!="undefined"&&d.setOptions(this.options)),d},d.prototype.addTime=function(a){this.foreach(function(b){b.addTime(a)})},d.prototype.foreach=function(a){var b=this;return this.elements.each(function(){var c=b.getInstance(this);typeof a=="function"&&a(c)}),this},d.prototype.start=function(){return this.foreach(function(a){a.start()}),this},d.prototype.stop=function(){return this.foreach(function(a){a.stop()}),this},d.prototype.restart=function(){return this.foreach(function(a){a.restart()}),this},d.prototype.rebuild=function(){return this.foreach(function(a){a.initialize(!1)}),this},d.prototype.getTime=function(){return this.getInstance(this.elements[0]).timeLeft()},d.prototype.addListener=function(b,a){typeof a=="undefined"&&(a="visible");var c=this;return this.foreach(function(d){d.addListener(b,c.elements,a)}),this},d.prototype.destroy=function(){return this.foreach(function(a){a.destroy()}),this},d.prototype.end=function(){return this.elements},a.fn.TimeCircles=function(a){return new d(this,a)}})(jQuery)